---
title: "FinalProject"
author: "Chirag Vithalani"
date: "November 28, 2015"
output: html_document
---

Required variables

```{r}
consumer_key<-"EeR30toLrNOqFWZXKdaMQsQHk"
consumer_secret<-"fdtVBdG6hIUZUpT8ZAq96huIhIZ8rHDqiZyIbhS1FTzniApUl2"
access_token<-"132916347-bs6C3Zrqx23TA7geqVOPy45859gPTDflNnRYzeUC"
access_secret<-"cnpmUd76s1z8e8RlfWzvoD0JjHYeanLyH6mzAB2G4hrrs"

install.packages(c("wordcloud","tm","twitteR","RCurl"),repos="http://cran.r-project.org")
require(twitteR)
require(RCurl)
require(wordcloud)
require(tm) #load text mining library
setup_twitter_oauth(consumer_key,consumer_secret,access_token,access_secret)
us_tweets<-searchTwitter("USelections",n=100,lang="en")
#us_tweets
us_text<- sapply(us_tweets,function(x) x$getText())
#head(us_text)
#abcd<-VectorSource(us_text)# a column of strings.
#us_corpus<-us_text
#us_corpus<-Corpus(DirSource("C://temp1/"))


us_corpus<- Corpus(VectorSource(us_text))
lords <- tm_map(us_corpus, stripWhitespace)
#lords <- tm_map(lords, tolower)
#for (i in 1:length(lords)){print(lords[[i]]$content)}
lords <- tm_map(lords, content_transformer(tolower))
lords <- tm_map(lords, removeNumbers)

toSpace <- content_transformer(function (x , pattern ) gsub(pattern, " ", x))
lords <- tm_map(lords, toSpace, "http\\S+\\s*")
lords <- tm_map(lords, toSpace, "http\\S+\\s*")

lords <- tm_map(lords, toSpace, "uselections")
lords <- tm_map(lords, toSpace, "#")
lords <- tm_map(lords, toSpace, "http\\w+")
lords <- tm_map(lords, toSpace, "@\\w+")

lords <- tm_map(lords, toSpace, "https\\w+")
#for (i in 1:length(lords)){print(lords[[i]]$content)}
lords <- tm_map(lords, toSpace, "uselect")
#lords <- tm_map(lords, removeWords, stopwords("english"))
lords <-tm_map(lords, removeWords, c(stopwords("english"),"#","uselect","uselection","obama","donaldtrump","trump","carson","donald","#uselect","uselections","elections","uselections  ","white","house"))

#lords <- gsub("@\\w+", "", lords) #clean URLs
#for (i in 1:length(lords)){print(lords[[i]]$content)}
#lords <- tm_map(lords, stemDocument)
#for (i in 1:length(lords)){print(lords[[i]]$content)}
#wordcloud(lords)
#scale basically controls the difference between the largest and smallest font
#max.words is required to limit the number of words in the cloud
wordcloud(lords,random.order=F,min.freq=1,max.words=200,colors=brewer.pal(8, "Dark2"))
#wordcloud(lords,random.order=F,min.freq=1,max.words=200,col=rainbow(50))
#wordcloud(lords.freq$Words, lords.freq$total)

```


